{% if contentDisplay %}
{% set layout = contentDisplay.layout | default("list") %}
{% set columns = contentDisplay.columns | default(1) %}

<div class="content-display-container py-4">
    <div class="space-y-4">
        {% if contentDisplay.headline %}
        <h2 class="text-xl font-semibold text-[var(--color-accent)] mb-3">{{ contentDisplay.headline | safe }}</h2>
        {% endif %}
        
        {# If collection is set, use it, otherwise default to pagination #}
        {% set items = collections[contentDisplay.collection] | default(pagination.items | default([])) %}

        {% if contentDisplay.reverse %}
            {% set items = items | reverse %}
        {% endif %}

        {% if contentDisplay.size and contentDisplay.size > 0 %}
            {% set items = items.slice(0, contentDisplay.size) %}
        {% endif %}

        {% if items and items.length > 0 %}
            {% if layout == "list" or columns == 1 %}
                {% set gridCols = "grid-cols-1" %}
                {% set cardClass = "border-b border-[var(--color-border)] last:border-b-0" %}
                {% set containerClass = "border-t border-b border-[var(--color-border)] bg-[var(--color-surface)]" %}
            {% elif columns == 2 %}
                {% set gridCols = "grid-cols-1 sm:grid-cols-2" %}
                {% set cardClass = "border border-[var(--color-border)]" %}
                {% set containerClass = "" %}
            {% elif columns == 3 %}
                {% set gridCols = "grid-cols-1 sm:grid-cols-2 lg:grid-cols-3" %}
                {% set cardClass = "border border-[var(--color-border)]" %}
                {% set containerClass = "" %}
            {% elif columns == 4 %}
                {% set gridCols = "grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4" %}
                {% set cardClass = "border border-[var(--color-border)]" %}
                {% set containerClass = "" %}
            {% else %}
                {% set gridCols = "grid-cols-1 sm:grid-cols-2 lg:grid-cols-3" %}
                {% set cardClass = "border border-[var(--color-border)]" %}
                {% set containerClass = "" %}
            {% endif %}
            
            <div class="{{ containerClass }}">
                <div class="grid {{ gridCols }} {% if columns > 1 %}gap-4{% endif %}">
                    {% for item in items %}
                    <div class="{{ cardClass }} bg-[var(--color-surface)] hover:bg-[var(--color-accent-strong)]/10 transition-colors duration-200 flex flex-col">
                        {% set itemUrl = item.url | url | default("#") %}
                        {% set itemTitle = item.data.title | default("Untitled Item") %}
                        <a href="{{ itemUrl }}" class="block p-{% if columns == 1 %}3{% else %}4{% endif %} h-full flex flex-col focus:outline-none focus:ring-1 focus:ring-[var(--color-accent-strong)]">
                            <h3 class="{% if columns == 1 %}text-base{% else %}text-lg{% endif %} font-medium text-[var(--color-accent)] hover:text-[var(--color-accent-hover)] mb-{% if columns == 1 %}1{% else %}2{% endif %} {% if columns > 1 %}line-clamp-2{% endif %}">
                                {{ itemTitle }}
                            </h3>
                            {% if item.date %}
                            <p class="{% if columns == 1 %}text-xs{% else %}text-sm{% endif %} text-[var(--color-text)]/{% if columns == 1 %}80{% else %}70{% endif %} mb-{% if columns == 1 %}1{% else %}2{% endif %}">{{ item.date | formatDateLong }}</p>
                            {% endif %}
                            {% if item.data.description %}
                            <p class="text-sm text-[var(--color-text)]/90 {% if columns > 1 %}line-clamp-3 flex-grow{% endif %}">{{ item.data.description }}</p>
                            {% endif %}
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        {% else %}
        <p class="text-center text-base border border-[var(--color-border)] p-4 bg-[var(--color-surface)]">{{ contentDisplay.emptyText | default("No items to display.") }}</p>
        {% endif %}
    </div>
</div>
{% endif %}

